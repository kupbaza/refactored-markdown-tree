# docs.safebox.zone ë‹¤êµ­ì–´(EN/JA) ìš´ì˜ ê°€ì´ë“œ (GitBook + Cloudflare)

ë³¸ ë¬¸ì„œëŠ” **docs.safebox.zone** ì‚¬ì´íŠ¸ì—ì„œ ì˜ì–´(EN)/ì¼ë³¸ì–´(JA) ë‹¤êµ­ì–´ë¥¼ GitBook Variantsë¡œ ìš´ì˜í•  ë•Œì˜ **ê¸°ë³¸ ì–¸ì–´ ì„¤ì •**, **ë¦¬ë‹¤ì´ë ‰íŠ¸ ì„¤ê³„**, **ë¸Œë¼ìš°ì € ì–¸ì–´ ìë™ ë¶„ê¸°(Cloudflare Workers)** êµ¬í˜„ ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.  
ë¬¸ì„œ í†¤ì€ ì¸í„°ë„· ì„œë¹„ìŠ¤ ì˜¨ë¼ì¸ ë§¤ë‰´ì–¼ í‘œì¤€ì„ ë”°ë¦…ë‹ˆë‹¤.

---

## 1) ê²°ë¡  ìš”ì•½

- **ê¸°ë³¸ ì–¸ì–´ë¥¼ ì˜ì–´ë¡œ ì„¤ì •**: ê°€ëŠ¥. GitBookì—ì„œ EN Variantë¥¼ **Default**ë¡œ ì§€ì •í•˜ë©´ ë£¨íŠ¸(`/`)ê°€ ENë¡œ ì„œë¹™ë©ë‹ˆë‹¤.
- **ë¸Œë¼ìš°ì € ì–¸ì–´ ìë™ ê°ì§€â†’í•´ë‹¹ ì–¸ì–´ ìë™ ì „í™˜**: GitBookì— **ë‚´ì¥ ê¸°ëŠ¥ ì—†ìŒ**.  
  âœ **ëŒ€ì•ˆ**: Cloudflare Workers(ë˜ëŠ” ì—ì§€ í”„ë¡ì‹œ)ì—ì„œ `Accept-Language` íŒë… í›„ **ìµœì´ˆ ë°©ë¬¸ 1íšŒ ë¦¬ë‹¤ì´ë ‰íŠ¸** êµ¬í˜„ + `lang` ì¿ í‚¤ë¡œ ì‚¬ìš©ì ì„ íƒ ê¸°ì–µ.

---

## 2) ê¸°ë³¸ ì–¸ì–´(EN)ë¡œ ì „í™˜ ë°©ë²•

1. GitBook ì½˜ì†” â†’ **Docs Site â†’ Settings â†’ Structure/Spaces(Variants)**  
2. ì˜ì–´ Variantì˜ ì˜µì…˜ ë©”ë‰´ì—ì„œ **Set as default** ì§€ì •  
3. ì ìš© ê²°ê³¼
   - ë£¨íŠ¸(`/`) = EN(ì˜ë¬¸) ì„œë¹™
   - ê¸°ì¡´ ì–¸ì–´ ê²½ë¡œëŠ” GitBookì˜ ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸/ìŠ¬ëŸ¬ê·¸ ì •ë¦¬ë¡œ ëŒ€ë¶€ë¶„ í˜¸í™˜
   - ì™¸ë¶€ ê³µìœ  ë§í¬ ì•ˆì •ì„± í™•ë³´ë¥¼ ìœ„í•´ **ì•„ë˜ ë¦¬ë‹¤ì´ë ‰íŠ¸ í‘œ**ë„ í•¨ê»˜ êµ¬ì„± ê¶Œì¥

---

## 3) ë¸Œë¼ìš°ì € ì–¸ì–´ ìë™ ê°ì§€ ì§€ì› ì—¬ë¶€

- GitBookì€ UI ë¬¸ìì—´(ë¼ë²¨ ë“±) í˜„ì§€í™”ëŠ” ì œê³µí•˜ë‚˜, **ì½˜í…ì¸  Variantë¥¼ ë¸Œë¼ìš°ì € ì–¸ì–´ë¡œ ìë™ ì „í™˜/ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ëŠ” ê¸°ëŠ¥ì€ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**
- GitBookì´ í˜¸ìŠ¤íŒ…/í—¤ë” ì£¼ì… ì»¤ìŠ¤í…€ JSë¥¼ í—ˆìš©í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, **ë„ë©”ì¸ ì•ë‹¨(ì˜ˆ: Cloudflare Workers, CDN/ì—ì§€ í”„ë¡ì‹œ)**ì—ì„œ `Accept-Language` í—¤ë”ë¥¼ íŒë…í•´ **ìµœì´ˆ ë°©ë¬¸ì‹œì—ë§Œ** í•´ë‹¹ ì–¸ì–´ Variant ê²½ë¡œë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ëŠ” ë°©ì‹ì„ ê¶Œì¥í•©ë‹ˆë‹¤. ì´í›„ ì‚¬ìš©ìê°€ ìˆ˜ë™ìœ¼ë¡œ ì–¸ì–´ë¥¼ ë°”ê¾¼ ê²½ìš°ì—ëŠ” ì¿ í‚¤ë¥¼ ë‘ì–´ **ì¬ë°©ë¬¸ ì‹œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ì§€ ì•Šë„ë¡** í•©ë‹ˆë‹¤.
- **Cloudflare Workers** ë˜ëŠ” ë‹¤ë¥¸ ì—ì§€ ë ˆì´ì–´ì—ì„œ ì²˜ë¦¬í•˜ëŠ”ê²Œ ì¢‹ì„ê²ƒ ê°™ìŠµë‹ˆë‹¤.

https://community.cloudflare.com/t/browser-language-detection-and-redirect/427408?utm_source=chatgpt.com

---

## 4) ê¶Œì¥ ìš´ì˜ ì•„í‚¤í…ì²˜

- **EN = ê¸°ë³¸(ë£¨íŠ¸)**, **JA = `/ja/` ìŠ¬ëŸ¬ê·¸**ë¡œ ìš´ìš©
- ìµœì´ˆ ë°©ë¬¸ ì‹œ **ì—ì§€ì—ì„œ 1íšŒì„± ê°ì§€**:
  - `Accept-Language`ê°€ `ja` â†’ `/ja/`ë¡œ 302
  - ê·¸ ì™¸ â†’ `/`(EN ìœ ì§€)
  - ì´í›„ì—ëŠ” ì‚¬ìš©ìì˜ ëª…ì‹œ ì„ íƒì„ **ì¿ í‚¤(`lang=en|ja`)**ë¡œ ìš°ì„ 
  - ìš´ì˜ ì‹œì—ëŠ” **ì‚¬ìš©ìê°€ ì–¸ì–´ ì„ íƒê¸°ë¥¼ í†µí•´ ì „í™˜í•  ë•Œ `lang` ì¿ í‚¤ë¥¼ ê°±ì‹ **í•˜ë„ë¡ ê°„ë‹¨í•œ ì¤‘ê°„ ê²½ë¡œ(ì˜ˆ: `/set-lang?l=ja` â†’ 302 `/ja/` + `Set-Cookie`)ë¥¼ ì¶”ê°€í•˜ë©´ UXê°€ ì¢‹ì•„ì§‘ë‹ˆë‹¤.
    
- GitBookì˜ **Site Redirects**ëŠ” ê°œë³„ ê²½ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ê´€ë¦¬ì— ìœ ìš©í•˜ì§€ë§Œ, **ë¸Œë¼ìš°ì € ì–¸ì–´ ê°ì§€ ë¡œì§ì„ ë‚´ì¥í•˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤**. ë”°ë¼ì„œ ìœ„ì™€ ê°™ì€ ì—ì§€ ë ˆë²¨ ì²˜ë¦¬ê°€ í˜„ì‹¤ì ì…ë‹ˆë‹¤.
- GitBook **Site Redirects**ë¡œ ê³¼ê±° ë§í¬/ìŠ¬ëŸ¬ê·¸ ì •ë¦¬(í‘œ ì°¸ì¡°)
- ì™¸ë¶€ ê³µìœ  ì‹œì—ëŠ” ê°€ëŠ¥í•˜ë©´ **ì–¸ì–´ ìŠ¬ëŸ¬ê·¸ ëª…ì‹œ**(ì˜ˆ: ì¼ë³¸ íŒŒíŠ¸ë„ˆ ê³µìœ  = `/ja/...`)

---

## 5) ë¦¬ë‹¤ì´ë ‰íŠ¸ í‘œ (ì˜ë¬¸ì„ ê¸°ë³¸ìœ¼ë¡œ ì „í™˜ ì‹œ)

> ì „ì œ: EN=ë£¨íŠ¸(ìŠ¬ëŸ¬ê·¸ ì—†ìŒ), JA=`/ja/`  
> ëª©ì : **ê³¼ê±° ë£¨íŠ¸=JA**ì˜€ë˜ ë§í¬ë¥¼ 404 ì—†ì´ ë³´ì „ + EN ë£¨íŠ¸ ì •ì°©

| ìš°ì„ ìˆœìœ„ | From(íŒ¨í„´) | To(ëŒ€ìƒ) | ì½”ë“œ | ë¹„ê³  |
|---:|---|---|:---:|---|
| 1 | `/ja` (ì •í™•íˆ) | `/ja/` | 301 | ìŠ¬ë˜ì‹œ ì •ê·œí™” |
| 2 | `/ja/*` | `/ja/:splat` | 301 | JA ë‚´ë¶€ ê²½ë¡œ ìœ ì§€ |
| 3 | `/en` (ì •í™•íˆ) | `/` | 301 | ENì€ ë£¨íŠ¸ê°€ ê¸°ë³¸ |
| 4 | `/en/*` | `/:splat` | 301 | EN ë‚´ë¶€ ê²½ë¡œëŠ” ë£¨íŠ¸ë¡œ |
| 5 | `/` | `/` | â€” | ë£¨íŠ¸=EN ìœ ì§€(ê·œì¹™ ë¶ˆí•„ìš”) |
| 6 | `/*` (ì„ ë³„) | `/ja/:splat` | 302 â†’ 2~4ì£¼ í›„ 301 ë˜ëŠ” ì œê±° | **ê³¼ê±° ë£¨íŠ¸=JAì˜€ì„ ë•Œ ìƒìœ„ ëŒ€í‘œ ê²½ë¡œ**ë§Œ ì„ì‹œ ìš´ìš© |

https://gitbook.com/docs/publishing-documentation/site-redirects?utm_source=chatgpt.com

### ë“±ë¡ ìœ„ì¹˜ (GitBook)
- **Site â†’ Settings â†’ Domain & redirects â†’ Site redirects**
- ì™€ì¼ë“œì¹´ë“œ(`*`, `:splat`) ì§€ì›
- 1â€“4ë²ˆì€ **ìƒì‹œ**, 6ë²ˆì€ **ì „í™˜ ê¸°ê°„ë§Œ** ìš´ìš© ê¶Œì¥

---

## 6) Cloudflare ì„¤ì •: ë¸Œë¼ìš°ì € ì–¸ì–´ ìë™ ë¶„ê¸° (2ì•ˆ)

### Aì•ˆ) Cloudflare í”„ë¡ì‹œ(ì£¼í™© êµ¬ë¦„ ON) + Worker ë¼ìš°íŒ… (**ê¶Œì¥**)

1. **DNS í™•ì¸**
   - `docs.safebox.zone` CNAME â†’ GitBook í˜¸ìŠ¤íŠ¸(ì˜ˆ: `hosting.gitbook.io`)
   - **í”„ë¡ì‹œ ON(ğŸŸ§)** ìœ¼ë¡œ ì „í™˜í•´ ì—ì§€ ì§‘í–‰ í™œì„±í™”
2. **Worker ìƒì„±**
   - Cloudflare Dashboard â†’ **Workers & Pages â†’ Create application â†’ Create Worker â†’ Deploy**
3. **ë¼ìš°íŠ¸ ì—°ê²°**
   - Workers & Pages â†’ í•´ë‹¹ Worker â†’ **Settings â†’ Domains & Routes â†’ Add route**
   - `docs.safebox.zone/*` ì¶”ê°€(ë˜ëŠ” í•„ìš”í•œ ì„œë¸ŒíŒ¨ìŠ¤)
   - ì—¬ëŸ¬ ë¼ìš°íŠ¸ê°€ ìˆì„ ê²½ìš° **êµ¬ì²´ì  ê²½ë¡œ ìš°ì„ **
4. **ë™ì‘ ì›ì¹™**
   - **ìµœì´ˆ ë°©ë¬¸**(`"/"` í˜¹ì€ ìµœìƒìœ„ ì§„ì… ê²½ë¡œ)ì—ì„œë§Œ `Accept-Language` íŒë…
   - `ja` ì„ í˜¸ ì‹œ `/ja/`ë¡œ **302** + `Set-Cookie: lang=ja`
   - ê·¸ ì™¸ EN ìœ ì§€ + `Set-Cookie: lang=en`
   - **ì¬ë°©ë¬¸ ì‹œ ì¿ í‚¤ ìš°ì„ **(ì‚¬ìš©ì ìˆ˜ë™ ì „í™˜ ì¡´ì¤‘)

> ë³´ì•ˆ ê¶Œì¥: `SameSite=Lax; Secure; Path=/; Max-Age=2592000`


---

### Bì•ˆ) GitBook ì¸¡ ì œì•½ìœ¼ë¡œ í”„ë¡ì‹œê°€ ë¶ˆê°€í•  ë•Œ (ìš°íšŒ)

- **B-1. ë³„ë„ ì§„ì… í˜¸ìŠ¤íŠ¸** `edge-docs.safebox.zone`ì— Worker ì—°ê²° â†’ ìµœì´ˆ ì§„ì…ë§Œ ì´ìª½ìœ¼ë¡œ ìœ ë„, ê°ì§€ í›„ `docs.safebox.zone/{ja|}`ë¡œ 302
- **B-2. íšŒì‚¬ í¬í„¸/í™ˆí˜ì´ì§€**ì—ì„œ ì–¸ì–´ ê°ì§€ í›„ GitBook URLì„ ë¶„ê¸°
- **B-3. ìë™ ê°ì§€ ì—†ì´** GitBookì˜ Site Redirects + ì–¸ì–´ ì„ íƒ UXë§Œ ìš´ì˜

---

## 7) Cloudflare Worker ì½”ë“œ ìŠ¤ë‹ˆí« (ì˜ˆì‹œ)

> ì‹¤ì œ ìŠ¬ëŸ¬ê·¸/ì˜ˆì™¸ ê²½ë¡œ/ë³´ì•ˆ ì •ì±…ì— ë§ê²Œ ì¡°ì •í•˜ì„¸ìš”.

```js
export default {
  async fetch(request, env, ctx) {
    const url = new URL(request.url);

    // ì‚¬ìš©ìê°€ ì„ íƒí•œ ì–¸ì–´ ì¿ í‚¤ê°€ ìˆìœ¼ë©´ ì¡´ì¤‘
    const cookie = request.headers.get("Cookie") || "";
    const chosen = /(?:^|;\s*)lang=(en|ja)(?:;|$)/.exec(cookie)?.[1];

    // ë£¨íŠ¸ ë˜ëŠ” ìµœìƒìœ„ ì§„ì…ì—ì„œë§Œ 1íšŒ ê°ì§€
    const isEntry = url.pathname === "/" || /^\/(docs|guide)\/?$/.test(url.pathname);

    if (!chosen && isEntry) {
      const al = request.headers.get("Accept-Language") || "";
      const preferJa = /^ja(\b|[-,;])/i.test(al);
      const dest = preferJa ? "/ja/" : "/";

      if (url.pathname !== dest) {
        url.pathname = dest;
        return new Response(null, {
          status: 302,
          headers: {
            "Location": url.toString(),
            "Set-Cookie":
              `lang=${preferJa ? "ja" : "en"}; Path=/; Max-Age=2592000; SameSite=Lax; Secure`,
          },
        });
      }
    }

    // ê·¸ ì™¸ ìš”ì²­ì€ ì›ë³¸(GitBook)ìœ¼ë¡œ í”„ë¡ì‹œ
    return fetch(request);
  }
}


### (ì„ íƒ) ì–¸ì–´ ì„ íƒê¸°ì™€ ì¿ í‚¤ ì—°ë™ ì—”ë“œí¬ì¸íŠ¸

- `/set-lang?l=ja|en` â†’ `Set-Cookie: lang=...` ì„¤ì • í›„ **302**ë¡œ í•´ë‹¹ ì–¸ì–´ ë£¨íŠ¸ë¡œ ì´ë™
    
- ì˜ˆ: `/set-lang?l=ja` â†’ 302 `/ja/`
    

---

## 8) ìš´ì˜ ì²´í¬ë¦¬ìŠ¤íŠ¸

-  GitBookì—ì„œ **EN Variant = Default** ì„¤ì •(ë£¨íŠ¸=EN)
    
-  **ë¦¬ë‹¤ì´ë ‰íŠ¸ í‘œ**(ìƒë‹¨ 1â€“4ë²ˆ ìƒì‹œ / 6ë²ˆ ì„ì‹œ) GitBookì— ë“±ë¡
    
-  **Cloudflare Aì•ˆ**(í”„ë¡ì‹œ+Worker) ë˜ëŠ” **Bì•ˆ**(ìš°íšŒ) ì¤‘ íƒ1
    
-  ìŠ¤í…Œì´ì§• ì„œë¸Œë„ë©”ì¸ìœ¼ë¡œ **ì‚¬ì „ ë¦¬í—ˆì„¤** ì§„í–‰
    
-  ì–¸ì–´ ì„ íƒê¸°ì™€ `lang` ì¿ í‚¤ ë™ê¸°í™”(ì„ íƒ)
    
-  ì „í™˜ í›„ 2~4ì£¼ ê²½ê³¼ ì‹œ, ì„ì‹œ 302 ê·œì¹™(í‘œ 6ë²ˆ) â†’ 301 ì „í™˜ ë˜ëŠ” ì œê±°